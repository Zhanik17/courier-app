<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∫—É—Ä—å–µ—Ä–∞</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; background: #f0f0f0; }
    h2 { color: #333; }
    .order { background: #fff; padding: 10px 15px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .completed { background: #e0ffe0; }
    button { margin-top: 8px; padding: 6px 12px; border: none; background-color: #28a745; color: white; border-radius: 4px; cursor: pointer; }
    button:hover { background-color: #218838; }
    hr { border: none; border-top: 1px solid #ccc; margin: 20px 0; }
  </style>
</head>
<body>
  <h2>üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –∫—É—Ä—å–µ—Ä!</h2>
  <h3>üöö –¢–µ–∫—É—â–∏–µ –∑–∞–∫–∞–∑—ã:</h3>
  <div id="current-orders"></div>

  <hr>

  <h3>‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã:</h3>
  <div id="completed-orders"></div>

  <script>
    // üëâ Firebase-–∫–æ–Ω—Ñ–∏–≥ —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
    const firebaseConfig = {
      apiKey: "AIzaSyD2fGiGUlv-D2_W04WRrxAFe34rNzB1FVU",
      authDomain: "courier-app-bcf64.firebaseapp.com",
      databaseURL: "https://courier-app-bcf64-default-rtdb.firebaseio.com",
      projectId: "courier-app-bcf64",
      storageBucket: "courier-app-bcf64.appspot.com",
      messagingSenderId: "328029865365",
      appId: "1:328029865365:web:8c9cd999a9b49d7cfb2d21"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const auth = firebase.auth();

    auth.onAuthStateChanged(user => {
      if (!user) {
        window.location.href = 'login.html';
        return;
      }

      const uid = user.uid;
      db.ref('orders').on('value', snapshot => {
        const orders = snapshot.val() || {};
        const currentOrders = document.getElementById('current-orders');
        const completedOrders = document.getElementById('completed-orders');
        currentOrders.innerHTML = '';
        completedOrders.innerHTML = '';

        Object.entries(orders).forEach(([id, order]) => {
          if (order.courierId === uid) {
            const div = document.createElement('div');
            div.className = 'order' + (order.status === 'completed' ? ' completed' : '');
            div.innerHTML = `
              <p><strong>–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞:</strong> ${order.name}</p>
              <p><strong>–û—Ç–∫—É–¥–∞:</strong> ${order.from}</p>
              <p><strong>–ö—É–¥–∞:</strong> ${order.to}</p>
              <p><strong>–ß—Ç–æ –¥–æ—Å—Ç–∞–≤–∏—Ç—å:</strong> ${order.what}</p>
            `;

            if (order.status === 'in-progress') {
              const btn = document.createElement('button');
              btn.textContent = '–í—ã–ø–æ–ª–Ω–µ–Ω–æ';
              btn.onclick = () => {
                db.ref('orders/' + id).update({ status: 'completed' });
              };
              div.appendChild(btn);
              currentOrders.appendChild(div);
            } else {
              completedOrders.appendChild(div);
            }
          }
        });
      });
    });
  </script>
</body>
</html>
